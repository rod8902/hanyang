######################################################################
# makefile_%%IDLFileBaseName%%_%%archName%%
#
# (c) Copyright, Real-Time Innovations, 2012.  All rights reserved.
# No duplications, whole or partial, manual or electronic, may be made
# without express written permission.  Any such copies, or
# revisions thereof, must display this notice unaltered.
# This code contains trade secrets of Real-Time Innovations, Inc.
#
#
# This makefile was automatically generated by rtiddsgen.
#
# To compile, type:
# 	gmake -f makefile_%%IDLFileBaseName%%_%%archName%%
#
# Note: This makefile is only meant to build our example applications and
#       may require alterations to build on your system.
#
# Make sure the environment variable JAMAICA is set.
#
# Make sure that WIND_HOME, WIND_BASE and WIND_USR are set.
# Alternatively, run $(WIND_BASE)/wrenv.sh -p <subdir> to set all
# necessary WindRiver environment variables.
#
######################################################################

JAVAC_PATH = $(JAMAICA)/bin/jamaicac
JAMAICABUILDER_PATH = $(JAMAICA)/bin/jamaicabuilder

JAVA_SOURCES = %%JavaSourceFiles%%

CLASS_FILES  = $(JAVA_SOURCES:%.java=%.class)

RTI_CLASSPATH = $(NDDSHOME)/class/nddsjava%%libSuffix%%.jar

RTI_LIBPATH = $(NDDSHOME)/lib/%%archName%%

RTI_STATICLIB = nddsjavaz%%libSuffix%%

DIRECTORIES   = objs.dir objs/%%archName%%.dir
 
%.class : %.java
	$(JAVAC_PATH) -useTarget %%TargetPlatform%% %%compilerDebugFlag%% -classpath .:$(RTI_CLASSPATH) $<
 
all: objs/%%archName%%/%%ExampleTypeClassPackage%%Publisher objs/%%archName%%/%%ExampleTypeClassPackage%%Subscriber

objs/%%archName%%/%%ExampleTypeClassPackage%%Publisher: $(CLASS_FILES) $(DIRECTORIES)
	$(JAMAICABUILDER_PATH) -classpath=.:$(RTI_CLASSPATH) -includeJar=$(RTI_CLASSPATH) -XlibraryPaths+=$(RTI_LIBPATH) -XstaticLibraries="$(RTI_STATICLIB)" -setGraphics=none -interpret -target=%%TargetPlatform%% -destination=$@ %%ExampleTypeClassPackage%%Publisher
 
objs/%%archName%%/%%ExampleTypeClassPackage%%Subscriber: $(CLASS_FILES) $(DIRECTORIES)
	$(JAMAICABUILDER_PATH) -classpath=.:$(RTI_CLASSPATH) -includeJar=$(RTI_CLASSPATH) -XlibraryPaths+=$(RTI_LIBPATH) -XstaticLibraries="$(RTI_STATICLIB)" -setGraphics=none -interpret -target=%%TargetPlatform%% -destination=$@ %%ExampleTypeClassPackage%%Subscriber

# Here is how we create those subdirectories automatically.
%.dir : 
	@echo "Checking directory $*"
	@if [ ! -d $* ]; then \
		echo "Making directory $*"; \
		mkdir -p $* ; \
	fi;
